<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Firebase Secure Init</title>
</head>
<body>

<script type="module" src="./firebase-init.js"></script>

</body>
</html>
const payload = {
    k1: "QUl6YVN5Q08zNDg3b09QdURnS2FRVThrelpKNU5xcV81ZW1QblE=",
    k2: "eHl6bGl4LmZpcmViYXNlYXBwLmNvbQ==",
    k3: "eHl6bGl4",
    k4: "eHl6bGl4LmZpcmViYXNlc3RvcmFnZS5hcHA=",
    k5: "NzEyNDE5NTcwMTE2",
    k6: "MToxNzEyNDE5NTcwMTE2OndlYjoyYjk3MmFkMzE2N2ViZTIyMzRiNDkx",
    k7: "Ry1HRTA0S0tKOVRG"
};

// Base64 â†’ Uint8
const b64ToBytes = (b64) =>
    Uint8Array.from(atob(b64), c => c.charCodeAt(0));

// Hash nazorati (haqiqiy vazifa)
const verify = async (bytes) => {
    const hash = await crypto.subtle.digest("SHA-256", bytes);
    return hash.byteLength === 32; // SHA-256 = 32 bayt
};

const decode = async (b64) => {
    const bytes = b64ToBytes(b64);
    if (!(await verify(bytes))) {
        throw new Error("Config integrity check failed");
    }
    return new TextDecoder().decode(bytes);
};

(async () => {
    const firebaseConfig = {
        apiKey: await decode(payload.k1),
        authDomain: await decode(payload.k2),
        projectId: await decode(payload.k3),
        storageBucket: await decode(payload.k4),
        messagingSenderId: await decode(payload.k5),
        appId: await decode(payload.k6),
        measurementId: await decode(payload.k7)
    };

    const { initializeApp } = await import(
        "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"
    );
    const { getAnalytics } = await import(
        "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js"
    );

    const app = initializeApp(firebaseConfig);
    getAnalytics(app);
})();
